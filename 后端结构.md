# Go后端项目文件架构

## 文件架构

```
/chat-system-backend
├── cmd
│   └── server
│       └── main.go                 # 应用入口文件
├── config
│   ├── config.go                   # 配置加载和管理
│   └── config.yaml                 # 配置文件
├── internal
│   ├── api
│   │   └── router.go               # 路由注册
│   ├── middleware
│   │   ├── auth.go                 # JWT认证中间件
│   │   └── logger.go               # 日志中间件
│   ├── model
│   │   ├── user.go                 # 用户模型
│   │   ├── message.go              # 消息模型
│   │   ├── friend.go               # 好友关系模型
│   │   └── chatroom.go             # 聊天室模型
│   ├── repository
│   │   ├── user_repository.go      # 用户数据访问
│   │   ├── message_repository.go   # 消息数据访问
│   │   ├── friend_repository.go    # 好友关系数据访问
│   │   └── chatroom_repository.go  # 聊天室数据访问
│   ├── service
│   │   ├── auth_service.go         # 认证服务
│   │   ├── user_service.go         # 用户服务
│   │   ├── message_service.go      # 消息服务
│   │   ├── friend_service.go       # 好友服务
│   │   └── chatroom_service.go     # 聊天室服务
│   ├── handler
│   │   ├── auth_handler.go         # 认证相关HTTP处理
│   │   ├── user_handler.go         # 用户相关HTTP处理
│   │   ├── message_handler.go      # 消息相关HTTP处理
│   │   ├── friend_handler.go       # 好友相关HTTP处理
│   │   └── chatroom_handler.go     # 聊天室相关HTTP处理
│   └── ws
│       ├── hub.go                  # WebSocket连接管理器
│       └── client.go               # WebSocket客户端
├── pkg
│   ├── db
│   │   └── mysql.go                # 数据库连接
│   ├── utils
│   │   ├── jwt.go                  # JWT工具
│   │   └── validator.go            # 数据验证工具
│   └── logger
│       └── logger.go               # 日志工具
├── migrations
│   └── 20230501_initial_schema.sql # 数据库迁移文件
├── go.mod
└── go.sum
```

## 主要目录说明

1. **cmd/server**
   - 应用的入口点，负责初始化配置、数据库连接，启动HTTP服务

2. **config**
   - 存放配置文件和配置加载代码

3. **internal/api**
   - 路由注册中心，定义所有API路由

4. **internal/middleware**
   - 中间件，处理认证、日志、错误等横切关注点

5. **internal/model**
   - 数据模型，定义数据库表结构对应的Go结构体

6. **internal/repository**
   - 数据访问层，直接与数据库交互

7. **internal/service**
   - 业务逻辑层，实现核心业务功能

8. **internal/handler**
   - HTTP处理层，处理HTTP请求和响应

9. **internal/ws**
   - WebSocket相关代码，处理实时通信

10. **pkg**
    - 可重用的公共包，如数据库连接、日志工具、JWT工具等

11. **migrations**
    - 数据库迁移文件，管理数据库结构变更